except for the implementation of sampler: MIT License
